RCC EQU 0x40021018	
	
GPIOA_CRL	EQU 0x40010800
GPIOA_CRH	EQU 0x40010804
GPIOA_IDR	EQU 0x40010808
GPIOA_ODR	EQU 0x4001080C
	
GPIOB_CRL	EQU	0x40010C00
GPIOB_CRH	EQU	0x40010C04
GPIOB_IDR	EQU	0x40010C08
GPIOB_ODR	EQU	0x40010C0C
	
AFIO_EXTICR2 EQU 0x4001000C
	
EXTI_IMR EQU 0x40010400
EXTI_EMR	EQU 0x40010404
EXTI_RTSR	EQU 0x40010408
EXTI_FTSR	EQU 0x4001040C
EXTI_PR	EQU 0x40010414
	
NVIC_ISER0	EQU 0xE000E100
NVIC_ICER0	EQU 0XE000E180
NVIC_ISPR0	EQU 0XE000E200
NVIC_ICPR0	EQU 0XE000E280


	EXPORT __main
	EXPORT EXTI4_IRQHandler
	AREA MAIN, CODE, READONLY
__main
	LDR	R1,=RCC
	LDR R0,[R1]			
	ORR R0,R0,#0xC		
	STR R0,[R1]			
	
	LDR R0, =GPIOB_CRL
	LDR R1, =0x80000
	STR R1, [R0]

	LDR R1,=GPIOA_CRL
	LDR R0,=0x33333333	
	STR R0,[R1]			

	LDR R1,=GPIOA_CRH
	LDR R0,=0x33333333
	STR R0,[R1]

	LDR R1,=AFIO_EXTICR2
	LDR R0,=1
	STR R0,[R1]

	LDR R1,=EXTI_IMR
	LDR R0,=0x10
	STR R0,[R1]
	
	LDR R1,=EXTI_FTSR
	LDR R0,=0x10
	STR R0,[R1]
	
	LDR R1,=NVIC_ISER0
	LDR R0,=0x400
	STR R0,[R1]
	
	
LOOP
	LDR R1,=GPIOA_ODR
	LDR R5, [R1]
	MVN R5, R5 		
	STR R5,[R1]
	
	
	BL delay
	B LOOP
EXTI4_IRQHandler
	LDR R1, =EXTI_PR
	LDR R0, =0x10
	STR R0, [R1]
	
	LDR R1, =GPIOA_ODR
	LDR R0, =1
	STR R0, [R1]
	BX LR
	
delay
		LDR R0,= 48		
d_L1	LDR R1,= 250000	
d_L2	SUBS R1,R1,#1		
		BNE	d_L2			
		SUBS R0,R0,#1
		BNE d_L1
		BX	LR		

S B S  
		END
